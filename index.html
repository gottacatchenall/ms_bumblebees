<!DOCTYPE html>
<html lang="" dir="ltr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Building a better metaweb: predicting spatiotemporally explicit plant-pollinator networks</title>
    <script src="https://hypothes.is/embed.js" async></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
    integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,400;0,500;1,400;1,500&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,400;0,700;1,400&display=swap');

        :root {
            --citation: #1976D2;
            --structure: hsl(210, 61%, 43%);

            --light: #474747;
            --pale: #a5a5a5;
            --grey: #e0e0e0;
            --nav: #fdfdfd;

            --width: 820px;
            --inner-space: 1.2em;
        }

        body {
            font-family: "Roboto", sans-serif;
            margin: 0 0;
            padding: 0 0;
        }

        article > p {
            line-height: 135%;
        }
        article > h1 {
            padding-top: 3em;
        }
        a {
            text-decoration: none;
            color: #000;
            border-bottom: 1px solid var(--structure);
        }
        a:hover {
            font-weight: 500;
        }
        .citation {
            color: var(--citation);
        }
        .container {
            margin: 0em auto;
            max-width: var(--width);
            padding: var(--inner-space);
        }
        header > .container {
            margin-top: 4em;
        }
        code, pre {
            font-family: "Roboto Mono", monospace;
        }
        pre {
            white-space: pre-wrap;
        }
        h1, h2, h3 {
            color: var(--structure);
            font-family: "Roboto", sans-serif;
            font-weight: 500;
        }
        header {
            font-family: "Roboto", sans-serif;
            z-index: 5;
            color: black;
            margin-top: 4rem;
        }
        .header--title {
            font-weight: 600;
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        .header--authors > span {
            color: var(--light);
            font-weight: 400;
        }
        main {
            padding-top: 8em !important;
            padding-bottom: 8em !important;
        }
        footer {
            background-color: var(--grey);
            font-weight: 300;
        }
        .abstract {
            color: var(--light);
            margin-bottom: 5em;
        }
        figure {
            max-width: 100%;
            border: 1px solid var(--pale);
            border-radius: 2px;
            margin: 1em 0.5em;
        }
        figure > img {
            max-width: 100%;
            display: block;
            margin: 0em auto;
        }
        figure > figcaption {
            padding: var(--inner-space);
        }
        table {
            width: 100%;
            min-width: 100%;
            border-collapse: collapse;
        }
        table > caption {
            padding: var(--inner-space);
        }
        figcaption, caption {
            color: var(--light);
            font-weight: 300;
        }
        thead {
            color: var(--structure);
        }
        td, th {
            padding: 3px;
        }
        tr {
            border-top: 1px solid var(--structure);
            border-bottom: 1px solid var(--structure);
        }
        tbody > tr:nth-child(even) {background: var(--grey)};
        tbody {
            border-bottom: 1px solid var(--structure);
        }
        #refs {
            font-size: 90%;
            column-count: 2;
        }
        #refs > .csl-entry {
            padding-bottom: 0.2em;
            padding-top: 0.2em;
        }
        .hanging-indent > .csl-entry {
            padding-left: 15px ;
            text-indent: -15px ;
        }    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.css"
    integrity="sha384-D+9gmBxUQogRLqvARvNLmA9hS2x//eK1FhVb9PiU86gmcrBrJAQT8okdJ4LMp2uv" crossorigin="anonymous" />
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.js"
    integrity="sha384-483A6DwYfKeDa0Q52fJmxFXkcPCFfnXMoXblOkJ4JcA8zATN6Tm78UNL72AKk+0O"
    crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/contrib/auto-render.min.js"
    integrity="sha384-yACMu8JWxKzSp/C1YV86pzGiQ/l1YUfE8oPuahJQxzehAjEt2GiQuy/BIvl9KyeF"
    crossorigin="anonymous"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            renderMathInElement(document.body, {
                delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false }
                ]
            });
        });
    </script>
</head>

<body>
    <header>
        <div class="container">
            <div class="header--title">Building a better metaweb: predicting spatiotemporally explicit plant-pollinator networks</div>
            <div class="header--authors">
                <span class="header--author">
                <a href="https://orcid.org/0000-0002-6506-6487" target="_blank">
                    Michael D. Catchen
                </a>
                <sup class="affilcode">1</sup>
                <sup class="affilcode">2</sup>
                </span><span class="header--author">
                Paul CaraDonna
                <sup class="affilcode">3</sup>
                <sup class="affilcode">4</sup>
                </span><span class="header--author">
                Jane E. Ogilvie
                <sup class="affilcode">3</sup>
                </span><span class="header--author">
                <a href="https://orcid.org/0000-0001-9051-0597" target="_blank">
                    Francis Banville
                </a>
                <sup class="affilcode">3</sup>
                </span><span class="header--author">
                <a href="https://orcid.org/0000-0002-2151-6693" target="_blank">
                    Dominique Caron
                </a>
                <sup class="affilcode">1</sup>
                <sup class="affilcode">2</sup>
                </span><span class="header--author">
                <a href="https://orcid.org/0000-0002-6248-3007" target="_blank">
                    Philippe Desjardins-Proulx
                </a>
                <sup class="affilcode">5</sup>
                <sup class="affilcode">2</sup>
                </span><span class="header--author">
                <a href="https://orcid.org/0000-0001-9019-0108" target="_blank">
                    Norma R. Forero-Muñoz
                </a>
                <sup class="affilcode">5</sup>
                <sup class="affilcode">2</sup>
                </span><span class="header--author">
                <a href="https://orcid.org/0000-0002-4498-7076" target="_blank">
                    Dominique Gravel
                </a>
                <sup class="affilcode">6</sup>
                <sup class="affilcode">2</sup>
                </span><span class="header--author">
                <a href="https://orcid.org/0000-0002-6004-4027" target="_blank">
                    Laura Pollock
                </a>
                <sup class="affilcode">1</sup>
                <sup class="affilcode">2</sup>
                </span><span class="header--author">
                <a href="https://orcid.org/0000-0001-6067-1349" target="_blank">
                    Tanya Strydom
                </a>
                <sup class="affilcode">5</sup>
                <sup class="affilcode">2</sup>
                </span><span class="header--author">
                <a href="https://orcid.org/0000-0002-0735-5184" target="_blank">
                    Timothée Poisot
                </a>
                <sup class="affilcode">5</sup>
                <sup class="affilcode">2</sup>
                </span><span class="header--author">
                Julian Resasco
                <sup class="affilcode">7</sup>
                </span><span class="header--author">
                <a href="https://orcid.org/0000-0001-6075-8081" target="_blank">
                    Andrew Gonzalez
                </a>
                <sup class="affilcode">1</sup>
                <sup class="affilcode">2</sup>
                </span>
            </div>
        </div>
    </header>
    
    <main class="container">
        <section class="abstract">
            

            <dl>
                    <dt>Purpose</dt>
                <dd>This template provides a series of scripts to render a markdown document into an interactive website and a series of PDFs.</dd>
                    <dt>Motivation</dt>
                <dd>It makes collaborating on text with GitHub easier, and means that we never need to think about the output.</dd>
                    <dt>Internals</dt>
                <dd>GitHub actions and a series of python scritpts. The markdown is handled with <code>pandoc</code>.</dd>
                </dl>

            <div class="artifacts">
                <a href="draft.pdf" title="Draft PDF" target="_blank">draft</a>
                <a href="preprint.pdf" title="Preprint PDF" target="_blank">preprint</a>
            </div>
        </section>
        
        <article>
            <h2 id="abstract">Abstract</h2>
            <p>Using a data set of [DESCRIBE EACH DATASET IN A NICE WAY], we predict a spatiotemporally explicit metaweb of interactions between bumblebees (<em>Bombus</em>) and wildflowers (within <em>find clade</em>). We integrate this data with crowdsourced occurrence data and climate data to [best paint the picture of the Colorado bumblebee-plant metaweb]. Using temporal climate data, we forecast how the spatiotemporal overlap of interacting species will change under proposed climate scenarios. We use this to estimate what interactions between bees and plants need the most attention to prevent the spatiotemporal decoupling of an interactions from threatening ecosystem functioning or the persistence of a species.</p>
            <h1 id="introduction">Introduction</h1>
            <p>Species interactions are important. It is ultimately interactions between individuals of different species that drive the structure, dynamics, and persistence of ecosystems, and the abundance and diversity of the species within them. Plant-pollinator interactions specifically drive the function and persistence of “architecture of biodiversity” <span class="citation" data-cites="Bascompte2007PlaMut">(Bascompte &amp; Jordano 2007)</span>. However, we are far from a robust understanding of plant-pollinator networks. This is because sampling interactions is costly. Interactions vary in space and time <span class="citation" data-cites="Poisot2015SpeWhy">(Poisot <em>et al.</em> 2015)</span>—particularlly relevent in this system <span class="citation" data-cites="CaraDonna2014ShiFlo">(CaraDonna <em>et al.</em> 2014)</span>. This is why there is interest in using models to predict interactions from sparse data <span class="citation" data-cites="Strydom2021">(<strong>Strydom2021?</strong>)</span>. In this paper, we combine several datasets, each spanning several years, to produce spatially and temporally explicit predictions of the bumblebee (genus <em>Bombus</em>) and wildflower pollination network across the state of Colorado.</p>
            <p>We do this in two parts: (1) metaweb prediction and (2) conditioning our metaweb prediction on co-occurrence probability. First, we build a model to predict the metaweb—the network of <em>all</em> interactions, aggregated across all times and spatial locations—of <em>Bombus</em> and wildflower species across Colorado. (Why do this? The metaweb is more predictable than local interactions.) We do this using network embedding <span class="citation" data-cites="cite">(<strong>cite?</strong>)</span>. Network embedding takes each node in the network (either a bumblebee or a wildflower) and represents it in a latent <span class="math inline"><em>n</em></span> dimensional space. Combination of running models on Temporal niche (T), Phylogenetic niche (P), Environmental niche (E), and relative abundance in community (RA).</p>
            <p>Second, we then use this metaweb to predict the structure of networks at specific locations and times of year <span class="citation" data-cites="Gravel2019BriElt">(Gravel <em>et al.</em> 2019)</span>. Finally we suggest a map of sampling priority, which suggests the locations to sample that will best improve our understanding of the Colorado <em>Bombus</em> pollination metaweb.</p>
            <p>Why is this good for science, what does this contribute to our understanding of plant-pollinator ints, networks, Bombus, predictive models, etc., and how can these results be useful.</p>
            <h1 id="data">Data</h1>
            <p>We use three separate field datasets to estimate the Colorado <em>Bombus</em> metaweb.</p>
            <h1 id="methods">Methods</h1>
            <figure>
            <img src="./figures/concept.png" alt="todo" /><figcaption aria-hidden="true">todo</figcaption>
            </figure>
            <h1 id="metaweb-model">Metaweb Model</h1>
            <h2 id="feature-embedding">Feature Embedding</h2>
            <h3 id="relative-abundance">Relative Abundance</h3>
            <h3 id="phylogenetic-features">Phylogenetic features</h3>
            <h4 id="phylogeny-construction">Phylogeny Construction</h4>
            <p>We construct phylogenies for both <em>Bombus</em> and wildflower species using barcode markers, mitochondrial COI and chloroplast rbcL, respectively. These sequences were obtained from NCBI GenBank for all species. For species for which no sequence was available (only a handful of plants), their was substituted with a barcode from a member of the same genus. Justify why this is fine here.</p>
            <p>These sequences were aligned using ClustalOmega v???, and then a posterior distribution of phylogenies and consensus tree was obtained via MrBayes v??, using XX substition model with gamma-distributed rates. Run until convergence, which here we define as the standard-deviation of splits falling below 0.1.</p>
            <h4 id="creating-an-embedding-from-phylogenies">Creating an embedding from phylogenies</h4>
            <p>We simulate traits.</p>
            <h3 id="environmental-niche-features">Environmental niche features</h3>
            <p>We take the 19 BioClim layers from CHELSA (cite; 1km resolution) and a map of elevation and PCA them. A resulting 4 layers cover 99.5% of the variance. We use species occurrence data from GBIF, and consider each occurrence record as a point in environment space. Then we fit a multivariate normal distribution to these points in environmental space.</p>
            <h3 id="temporal-niche-features">Temporal niche features</h3>
            <p>We take the mean and variance of the distribution of number of observations per week of year in the interaction field data.</p>
            <h2 id="metaweb-model-fitting-and-validation">Metaweb Model Fitting and Validation</h2>
            <p>We fit a bunch of models using MLJ.jl.</p>
            <p>Some of them are bagged, some are not bagged.</p>
            <p>AUC-ROC and AUC-PR values below in fig. 1</p>
            <figure>
            <img src="./figures/PR_ROC.png" id="fig:prroc" alt="Figure 1: todo" /><figcaption aria-hidden="true">Figure 1: todo</figcaption>
            </figure>
            <p>What does this tell us? The ensemble model is regularlly the best for ROC, but not for PR. This illustrates a tradeoff between models being as “right” as possible versus a model being useful for discovering false-negatives.</p>
            <h1 id="spatiotemporally-explicit-networks">Spatiotemporally Explicit Networks</h1>
            <p>Now that we have a metaweb, we can extend this to predict interactions at partilar places and times by decomposing the probability of interaction at particular place and time into probability of interaction times probability of cooccurrence via properties of conditional prob. <span class="citation" data-cites="Gravel2019BriElt">(Gravel <em>et al.</em> 2019)</span></p>
            <p><span class="math inline"><em>P</em>(<em>A</em><sub><em>i</em><em>j</em></sub>)<em>P</em>(<em>O</em><sub><em>i</em><em>j</em></sub>)</span> vs <span class="math inline"><em>P</em>(<em>A</em><sub><em>i</em><em>j</em></sub>)<em>P</em>(<em>O</em><sub><em>i</em></sub>)<em>P</em>(<em>O</em><sub><em>j</em></sub>)</span></p>
            <p><strong><em>Figure 3: Maps over time figure and Prob(Connectance) vs. Month figure</em></strong></p>
            <h1 id="sampling-prioiritization">Sampling Prioiritization</h1>
            <p><strong><em>Figure 4: Uncertainty and sampling priority map</em></strong></p>
            <h1 class="unnumbered" id="discussion">Discussion</h1>
            <div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
            <div id="ref-Bascompte2007PlaMut" class="csl-entry" role="doc-biblioentry">
            Bascompte, J. &amp; Jordano, P. (2007). Plant-Animal Mutualistic Networks: The Architecture of Biodiversity. <em>Annual Review of Ecology, Evolution, and Systematics</em>, 38, 567–593.
            </div>
            <div id="ref-CaraDonna2014ShiFlo" class="csl-entry" role="doc-biblioentry">
            CaraDonna, P.J., Iler, A.M. &amp; Inouye, D.W. (2014). Shifts in flowering phenology reshape a subalpine plant community. <em>Proceedings of the National Academy of Sciences</em>, 111, 4916–4921.
            </div>
            <div id="ref-Gravel2019BriElt" class="csl-entry" role="doc-biblioentry">
            Gravel, D., Baiser, B., Dunne, J.A., Kopelke, J.-P., Martinez, N.D., Nyman, T., <em>et al.</em> (2019). Bringing Elton and Grinnell together: A quantitative framework to represent the biogeography of ecological interaction networks. <em>Ecography</em>, 42, 401–415.
            </div>
            <div id="ref-Poisot2015SpeWhy" class="csl-entry" role="doc-biblioentry">
            Poisot, T., Stouffer, D.B. &amp; Gravel, D. (2015). Beyond species: Why ecological interaction networks vary through space and time. <em>Oikos</em>, 124, 243–251.
            </div>
            </div>
        </article>
    </main>

    <footer>
        <div class="container">
            <h2>Affiliations</h2> 
            <sup>1</sup>&nbsp;McGill University; <sup>2</sup>&nbsp;Québec Centre for Biodiversity Sciences; <sup>3</sup>&nbsp;Rocky Mountain Biological Laboratory; <sup>4</sup>&nbsp;Chicago Bontanic Garden; <sup>5</sup>&nbsp;Université de Montréal; <sup>6</sup>&nbsp;Université de Sherbrooke; <sup>7</sup>&nbsp;University of Colorado Boulder
            <br />
            
        </div>
    </footer>
    
</body>
</html>